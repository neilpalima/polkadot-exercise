(this["webpackJsonppolkadot-exercise-frontend"]=this["webpackJsonppolkadot-exercise-frontend"]||[]).push([[0],{1051:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),c=t(35),o=t.n(c),i=t(1094),s=t(404),l=t(619),u=t(49),d=t(1082),b=t(490),j=t(182),f=t(489),p=t(23),h=Object(f.a)((function(e){return{appBar:{flexGrow:1},title:{flexGrow:1}}}));function m(){var e=h();return Object(p.jsx)(d.a,{className:e.appBar,children:Object(p.jsx)(b.a,{children:Object(p.jsx)(j.a,{variant:"h6",color:"inherit",className:e.title,children:"Polkadot Scanner"})})})}function x(){return Object(p.jsxs)(j.a,{variant:"body2",color:"textSecondary",children:["Copyright \xa9 ","Polkadot Scanner"," ",(new Date).getFullYear(),"."]})}var v=Object(f.a)((function(e){return{footer:{padding:e.spacing(3),marginTop:"auto"}}}));function O(){var e=v();return Object(p.jsx)("footer",{className:e.footer,children:Object(p.jsx)(x,{})})}var g=t(1093),k=t(1098),w=t(616),y=t.n(w),B=t(257),S=function(){return Object(B.b)()},E=B.c,C=t(1084),N=t(1085),q=Object(f.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}));function W(){var e=q();return Object(p.jsx)("div",{children:Object(p.jsx)(C.a,{className:e.backdrop,open:!0,children:Object(p.jsx)(N.a,{color:"inherit"})})})}var P=t(29),R=t.n(P),D=t(36),T=t(214),A=t(148),F=t(1096),I=t(1095),M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wss://rpc.polkadot.io",n=new F.a(e);return new Promise(function(){var e=Object(D.a)(R.a.mark((function e(t,r){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.on("error",(function(){n.disconnect(),r("Failed to connect polkadot endpoint")})),n.on("connected",(function(){return I.a.create({provider:n}).then(t).catch(r)}));case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}())},H=function(){var e=Object(D.a)(R.a.mark((function e(n){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=4;break}return e.next=3,M();case 3:n=e.sent;case 4:return e.next=7,n.rpc.chain.getHeader();case 7:return t=e.sent,e.abrupt("return",t.number.toNumber());case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),z=function(){var e=Object(D.a)(R.a.mark((function e(n,t){var r,a,c,o;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.rpc.chain.getBlockHash(t);case 2:return r=e.sent,e.next=5,n.rpc.chain.getBlock(r);case 5:return a=e.sent,e.next=8,n.query.system.events.at(a.block.header.hash);case 8:return c=e.sent,o=[],a.block.extrinsics.forEach((function(e,n){var r=e.method,a=r.method,i=r.section,s="".concat(i,".").concat(a);c.filter((function(e){var t=e.phase;return t.isApplyExtrinsic&&t.asApplyExtrinsic.eq(n)})).forEach((function(e){var n=e.event;return o.push({event:"".concat(n.section,".").concat(n.method),data:n.data.toHuman(),extrinsic:s,block:t})}))})),e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),J=function(){var e=Object(D.a)(R.a.mark((function e(n){var t,r,a,c,o,i,s;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(n.endpoint);case 2:return t=e.sent,e.next=5,H(t);case 5:if(r=e.sent,a=+n.startBlock,c=+n.endBlock,!(r<c)){e.next=10;break}throw new Error("Start/end block exceeds latest block: ".concat(r));case 10:for(o=[],i=a;i<=c;i++)o.push(z(t,i));return e.next=14,Promise.all(o);case 14:return s=e.sent,e.abrupt("return",s.flat());case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),L={value:null,loading:!1},G={events:Object(T.a)({},L),latestBlock:Object(T.a)({},L)},V=Object(A.b)("scan/fetchEvents",function(){var e=Object(D.a)(R.a.mark((function e(n){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),Y=Object(A.b)("scan/latestBlock",Object(D.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),$=Object(A.c)({name:"scan",initialState:G,reducers:{resetError:function(e){e.error=void 0}},extraReducers:function(e){e.addCase(V.pending,(function(e){e.events.loading=!0,e.events.value=[],e.error=void 0})).addCase(V.fulfilled,(function(e,n){e.events.loading=!1,e.events.value=n.payload})).addCase(V.rejected,(function(e,n){e.events.loading=!1,e.error=n.error.message})).addCase(Y.pending,(function(e){e.latestBlock.loading=!0,e.error=void 0})).addCase(Y.fulfilled,(function(e,n){e.latestBlock.loading=!1,e.latestBlock.value=n.payload})).addCase(Y.rejected,(function(e,n){e.latestBlock.loading=!1,e.error=n.error.message}))}}),K=$.actions.resetError,Q=function(e){return e.scan.error},U=function(e){return e.scan.events},X=function(e){return e.scan.latestBlock},Z=$.reducer,_=t(1092),ee=t(520),ne=t(1097),te=t(84),re=t(216),ae=t(149),ce=Object(f.a)((function(e){return{form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(2,0,6)}}})),oe=ae.b().shape({startBlock:ae.a().required("Required").min(1).integer("Must be a whole number").max(ae.c("endBlock"),"Must be less than or equal to end block"),endBlock:ae.a().min(1).integer("Must be a whole number").required("Required"),endpoint:ae.d().required("Required")});var ie=function(e){var n=e.onSubmit,t=e.onCloseError,r=e.latestBlock,a=e.loading,c=e.error,o=ce();return Object(p.jsx)(te.c,{initialValues:{startBlock:"",endBlock:null!==r&&void 0!==r?r:"",endpoint:"wss://rpc.polkadot.io"},enableReinitialize:!0,validationSchema:oe,onSubmit:function(e,t){(0,t.setSubmitting)(!1),n(e)},children:function(e){var n=e.submitForm;return Object(p.jsxs)(te.b,{className:o.form,children:[c&&Object(p.jsx)(ne.a,{severity:"error",onClose:t,children:c}),Object(p.jsx)(s.a,{children:Object(p.jsx)(te.a,{component:re.a,name:"startBlock",type:"number",label:"Start Block",margin:"normal",fullWidth:!0})}),Object(p.jsx)(s.a,{children:Object(p.jsx)(te.a,{component:re.a,name:"endBlock",type:"number",label:"End Block",margin:"normal",fullWidth:!0})}),Object(p.jsx)(s.a,{children:Object(p.jsx)(te.a,{component:re.a,name:"endpoint",type:"text",label:"Endpoint",margin:"normal",fullWidth:!0})}),a&&Object(p.jsx)(s.a,{margin:"10px 0px",children:Object(p.jsx)(_.a,{})}),Object(p.jsx)(ee.a,{className:o.submit,variant:"contained",color:"primary",disabled:a,onClick:n,fullWidth:!0,children:"Scan"})]})}})},se=t(585),le=t(418),ue=t.n(le),de=function(e){var n=e.label,t=e.onDelete;return Object(p.jsx)(se.a,{variant:"outlined",color:"secondary",label:n,onDelete:t})},be=function(e){return Object(p.jsx)(le.TableFilterList,Object(T.a)(Object(T.a)({},e),{},{ItemComponent:de}))};var je=function(e){var n=e.data,t=[{name:"block",label:"Block",options:{filter:!0,sort:!0}},{name:"extrinsic",label:"Extrinsic",options:{filter:!1,sort:!0}},{name:"event",label:"Event",options:{filter:!1,sort:!0}},{name:"data",label:"Event Data",options:{filter:!1,sort:!0,customBodyRender:function(e){if("object"===typeof e&&Array.isArray(e)){var n=e[0];return"object"===typeof n?JSON.stringify(n):n}return e}}}];return Object(p.jsx)(s.a,{width:"100%",children:Object(p.jsx)(ue.a,{title:"",data:n,columns:t,options:{elevation:2,rowsPerPage:25,rowsPerPageOptions:[10,25,50],selectableRows:"none",responsive:"standard",textLabels:{body:{noMatch:"Sorry, no matching records found",toolTip:"Sort",columnHeaderTooltip:function(e){return"Sort for ".concat(e.label)}}},search:!1,download:!1,print:!1,viewColumns:!1,filter:!0},components:{TableFilterList:be}})})},fe=Object(f.a)((function(e){return{root:{margin:e.spacing(10,0,8)},center:{display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(2),backgroundColor:e.palette.primary.main}}}));function pe(){var e=E(U),n=E(X),t=E(Q),a=S(),c=fe();Object(r.useEffect)((function(){a(Y())}),[a]);var o=e.value||[];return Object(p.jsxs)(s.a,{className:c.root,children:[n.loading&&Object(p.jsx)(W,{}),Object(p.jsx)(g.a,{maxWidth:"sm",children:Object(p.jsxs)(s.a,{className:c.center,children:[Object(p.jsx)(k.a,{className:c.avatar,children:Object(p.jsx)(y.a,{})}),Object(p.jsx)(j.a,{component:"h1",variant:"h5",children:"Scan"}),Object(p.jsx)(ie,{onSubmit:function(e){a(V(e))},onCloseError:function(){a(K())},latestBlock:n.value,loading:e.loading,error:t})]})}),Object(p.jsx)(g.a,{maxWidth:"xl",children:o.length>0&&Object(p.jsx)(je,{data:o})})]})}var he=t(618),me=t.n(he),xe=t(617),ve=t.n(xe),Oe=function(){var e=Object(D.a)(R.a.mark((function e(n){var t,r,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ve.a.post("/authentication",{password:n});case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),a=(null===e.t0||void 0===e.t0||null===(t=e.t0.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||e.t0.message,new Error(a);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(n){return e.apply(this,arguments)}}(),ge=Object(A.b)("auth/authenticate",function(){var e=Object(D.a)(R.a.mark((function e(n){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe(n);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),ke=Object(A.c)({name:"counter",initialState:{authenticated:!1,loading:!1},reducers:{resetError:function(e){e.error=void 0}},extraReducers:function(e){e.addCase(ge.pending,(function(e){e.loading=!0,e.error=void 0})).addCase(ge.fulfilled,(function(e){e.loading=!1,e.authenticated=!0})).addCase(ge.rejected,(function(e,n){e.loading=!1,e.error=n.error.message}))}}),we=ke.actions.resetError,ye=function(e){return e.auth},Be=ke.reducer,Se=Object(f.a)((function(e){return{form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(2,0,6)}}})),Ee=ae.b().shape({password:ae.d().required("Required")});var Ce=function(e){var n=e.onSubmit,t=e.onCloseError,r=e.loading,a=e.error,c=Se();return Object(p.jsx)(te.c,{initialValues:{password:""},validationSchema:Ee,onSubmit:function(e,t){(0,t.setSubmitting)(!1),n(e.password)},children:function(e){var n=e.submitForm;return Object(p.jsxs)(te.b,{className:c.form,children:[a&&Object(p.jsx)(ne.a,{severity:"error",onClose:t,children:a}),Object(p.jsx)(s.a,{children:Object(p.jsx)(te.a,{component:re.a,name:"password",type:"password",label:"Password",margin:"normal",fullWidth:!0})}),r&&Object(p.jsx)(s.a,{margin:"10px 0px",children:Object(p.jsx)(_.a,{})}),Object(p.jsx)(ee.a,{className:c.submit,variant:"contained",color:"primary",disabled:r,onClick:n,fullWidth:!0,children:"Scan"})]})}})},Ne=Object(f.a)((function(e){return{root:{margin:e.spacing(10,0,8)},center:{margin:e.spacing(10,0,8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(2),backgroundColor:e.palette.primary.main}}}));function qe(){var e=E(ye),n=e.authenticated,t=e.loading,a=e.error,c=S(),o=Object(u.g)(),i=Ne();Object(r.useEffect)((function(){n&&o.push("/")}),[n]);return Object(p.jsx)(g.a,{maxWidth:"sm",children:Object(p.jsxs)(s.a,{className:i.center,children:[Object(p.jsx)(k.a,{className:i.avatar,children:Object(p.jsx)(me.a,{})}),Object(p.jsx)(j.a,{component:"h1",variant:"h5",children:"Authentication"}),Object(p.jsx)(Ce,{onSubmit:function(e){c(ge(e))},onCloseError:function(){c(we())},loading:t,error:a})]})})}var We=function(){return Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(i.a,{}),Object(p.jsxs)(s.a,{display:"flex",flexDirection:"column",height:"100vh",children:[Object(p.jsx)(m,{}),Object(p.jsx)(l.a,{children:Object(p.jsxs)(u.d,{children:[Object(p.jsx)(u.b,{exact:!0,path:"/login",children:Object(p.jsx)(qe,{})}),Object(p.jsx)(u.b,{exact:!0,path:"/",children:Object(p.jsx)(pe,{})}),Object(p.jsx)(u.a,{to:"/"})]})}),Object(p.jsx)(O,{})]})]})},Pe=Object(A.a)({reducer:{auth:Be,scan:Z}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(B.a,{store:Pe,children:Object(p.jsx)(We,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},655:function(e,n){},661:function(e,n){},662:function(e,n){},667:function(e,n){},668:function(e,n){},687:function(e,n){},689:function(e,n){},695:function(e,n){}},[[1051,1,2]]]);
//# sourceMappingURL=main.297f5fb3.chunk.js.map